# Basic stuff.
-- MARK --
^[:blank:]*$

# Cron.
CRON.*: session closed for user root
CRON.*: session opened for user root
CRON.*: session closed for user logbot
CRON.*: session opened for user logbot
CRON.*: (root) CMD (.* run-parts --report /etc/cron.hourly
CRON.*: (root) CMD (.* run-parts --report /etc/cron.daily
CRON.*: (root) CMD (.* run-parts --report /etc/cron.weekly
CRON.*: (root) CMD (.* run-parts --report /etc/cron.monthly
CRON.*: (logbot) CMD (/home/logbot/bin/ai.sh)

# eventbot cron job
09:00:0[0-2] .* CRON\[.* session opened for user eventbot
09:00:0[0-2] .* CRON\[.* (eventbot) CMD (\$HOME/ironhorse
09:[01][0-9]:[0-9][0-9] .* postfix/pickup\[.* from=<eventbot>
09:[01][0-9]:[0-9][0-9] .* postfix/qmgr\[.* from=<eventbot@eventarelli.com>
09:[01][0-9]:[0-9][0-9] .* CRON\[.* session closed for user eventbot

# Not sure why this comes out lower case sometimes.
cron.*: (root) RELOAD (crontabs/root)

#
# Commented out 12/21/2014, see how noisy they are.
#
# Don't notify when crontab changes.
# If cron runs something unexpected,
# we'll get emailed the CMD entry.
crontab.*: (root) LIST (.*)
#crontab.*: (root) BEGIN EDIT (root)
#crontab.*: (root) REPLACE (root)
#crontab.*: (root) END EDIT (root)
#crontab.*: (root) RELOAD (root)

# Swallow ansible messages.
ansible-[^:]*:

# ssh and su
sshd.*: Received disconnect from 24.*
sshd.*: Accepted publickey for root from 24.*
su.*: pam_unix(su:session): session opened for user .* by root(uid=0)
su.*: pam_unix(su:session): session closed for user .*
su.*: Successful su for .* by root
su.*: + /dev/pts/0 root:.*

# Postfix
# Really strict for now, hardly sending any mail.
postfix/anvil.*: statistics:
postfix/smtp.*: .* to=<mkbucc@gmail.com>.* status=sent (250 Great success)
postfix/qmgr.*: .*: removed
postfix/qmgr.*: .*: from=<root@eventarelli.com>.*
postfix/pickup.*: .* from=<root>
postfix/cleanup.*: .*: message-id=.*
:00:0[0-5].* postfix/pickup.* from=<logbot>
:00:0[0-5].* postfix/qmgr.* from=<logbot@eventarelli.com>,

# /var/log/udev
# There are no rules defined under /etc/udev/rules.d
# so I'm not sure why this was logged.
monitor will print the received events for:

# dpkg
# This one is a tough one.
# The log entries are so short,
# you need to use broad regular expressions
# and then risk swallowing errors you want.
# Maybe skip package notifications entirely
# by adding dpkg.log to stopfiles
# and be happy with daemon restart messages.
# Leave in for now.
 status unpacked
update-alternatives: run with .*
status half-configured
status half-installed
startup packages configure
configure .* 436-1
trigproc
status triggers-pending
startup archives unpack
update-alternatives: link

# syslog-ng
syslog-ng.*: Configuration reload request received, reloading configuration;

# tmUnblock.cgi is a binary CGI executable in some Cisco/Linksys router
# that has multiple security holes that permit various attacks on the router.
GET /tmUnblock\.cgi HTTP/1\.1" 400

# Someone made an empty request to nginx.
# Both Chrome and Firefox open more than two
# simultaneous connections to a web site.
# If one of the connections is not needed to pull data,
# then you get 400 in access_log
# and "closed prematurely" in error_log.
#
# From http://it.randomthemes.com/2012/08/24/153/:
#
#       modern browsers open 2+ simultanious connections,
#       but some of them frequently not used for data
#       transfer, so nginx close them by timeout with
#       400 code at access.log
#
 "-" 400 0 "-" "-"
 "-" 400 "-" "-"
client closed prematurely connection while reading client request line

#
GET /[a-z]\{4\}/[a-z]\{3\}/[a-z]\{2\}\.php HTTP/1\.1" 404
#GET /anan/ana/an\.php HTTP/1\.1" 404
#GET /czcz/czc/cz\.php HTTP/1\.1" 404
#GET /gaga/gag/ga\.php HTTP/1\.1" 404
#GET /hjhj/hjh/hj\.php HTTP/1\.1" 404
#GET /lyly/lyl/ly\.php HTTP/1\.1" 404
#GET /ococ/oco/oc\.php HTTP/1\.1" 404
#GET /oyoy/oyo/oy\.php HTTP/1\.1" 404
#GET /vzvz/vzv/vz\.php HTTP/1\.1" 404

# Someone testing if redirects are allowed.
GET http://[^"]\+ HTTP/1\.1" \(404\|200\)

# Exploit attempts.
GET /.*/setup\.php HTTP/1\.1" 40[04]
GET /HNAP1/ HTTP/1\.1" 40[04]
GET /actionnews/index/ HTTP/1\.1" 40[04]
GET /blog HTTP/1\.1" 40[04]
GET /cgi-bin/php4 HTTP/1\.1" 40[04]
GET /cgi-bin/test-cgi HTTP/1\.1" 40[04]
GET /css/css HTTP/1.0" 40[04]
GET /drupal HTTP/1\.1" 40[04]
GET /joomla HTTP/1\.1" 40[04]
GET /manager/html HTTP/1\.1" 40[04]
GET /muieblackcat HTTP/1\.1" 40[04]
GET /robots\.txt HTTP/1\.1" 40[04]
GET /rom-0 HTTP/1\.1" 40[04]
GET /user/soapCaller\.bs HTTP/1\.1" 40[04]
GET /w00tw00t[^"]\+ HTTP/1.1" 404
GET /wordpress HTTP/1\.1" 40[04]
GET /wp HTTP/1\.1" 40[04]
HEAD /rom-0 HTTP/1.1" 404
POST /cgi-bin/php[^"]\+" 40[04]
POST /login\.action HTTP/1\.1" 404

# Not sure, probing?
GET / HTTP/1.1" 400 "-" "-"

# The normal website pages.
GET / HTTP/1\.[01]" \(304\|200\)
GET /api/chkdt HTTP/1.1" 400
GET /colorbrewer\.v1\.min\.js HTTP/1\.1" \(304\|200\)
GET /d3\.v3\.min\.js HTTP/1\.1" \(304\|200\)
GET /favicon\.ico HTTP/1\.1" 40[04]
GET /feedback/ HTTP/1\.1" 200
GET /forms\.css HTTP/1\.[01]" \(304\|200\)
GET /ma-counties\.json HTTP/1\.1" \(304\|200\)
GET /map\.js HTTP/1\.1" \(304\|200\)
GET /media_outlets/ HTTP/1\.1" \(304\|200\)
GET /reset\.css HTTP/1\.[01]" \(304\|200\)
GET /rhythm\.css HTTP/1\.[01]" \(304\|200\)
GET /style\.css HTTP/1\.[01]" \(304\|200\)
GET /submit/ HTTP/1.1" \(304\|200\)
GET /surf\.jpg HTTP/1\.[01]" \(304\|200\)
GET /topojson\.v1\.min\.js HTTP/1\.1" \(304\|200\)

# Netcraft and it's ilk.
HEAD / HTTP/1\.1" 200 .* Netcraft Web Server Survey
HEAD / HTTP/1\.0" 200 .* NetcraftSurveyAgent
HEAD / HTTP/1\.1" 200 .* DomainTunoCrawler
HEAD / HTTP/1\.0" 200 "-" "-"

# error_log - normal behavior.
client [0-9.]\+ closed keepalive connection
05:45:0[0-9] .* reopening logs

# Before ignoring next one (which I've seen),
# read http://serverfault.com/questions/322415/securing-nginx-proxy
# client timed out (110: Connection timed out) while reading client request headers
client sent HTTP/1.1 request without "Host" header
client sent invalid header line: "
